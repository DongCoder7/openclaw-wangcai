

---

## 8️⃣ 订单与营收预测模块

**调用**: `predict_revenue_growth(stock_code, current_revenue)`

**功能**:
- 自动抓取巨潮资讯网公告（重大合同/业绩预告等）
- 自动抓取深交所互动易投资者问答
- 从公告自动提取订单金额（亿元/万元）
- 三情景营收增速预测（保守/中性/乐观）
- 基于营收预测净利润（考虑毛利率/费用率）

**预测模型**:

### 营收增速预测
```
营收增速 = 订单增速 × 交付率 × 价格变化

三情景假设:
- 保守: 订单增速 × 0.5, 交付率 60%, 价格下降 5%
- 中性: 订单增速 × 1.0, 交付率 75%, 价格持平
- 乐观: 订单增速 × 1.3, 交付率 90%, 价格上涨 5%
```

### 净利润预测
```
净利润 = 营收 × 毛利率 - 费用 - 所得税
       = 营收 × (毛利率 - 费用率) × (1 - 税率)

默认假设:
- 毛利率: 35% (光模块行业)
- 费用率: 25%
- 所得税率: 15%
```

**数据源**:
| 来源 | 类型 | 覆盖内容 |
|:-----|:-----|:---------|
| 巨潮资讯网 | 官方公告 | 重大合同/业绩预告/增减持 |
| 互动易 | 投资者问答 | 订单细节/客户导入/产能 |
| 手动输入 | 补充数据 | 最新订单/非公告订单 |

**示例**:
```python
# 预测长芯博创营收和净利润
predictor = OrderRevenuePredictor()
result = predictor.analyze_stock(
    stock_code="300548.SZ",
    stock_name="长芯博创",
    current_revenue=35.0  # 当前营收35亿
)

# 输出:
# 📊 营收预测结果:
#   保守: 订单增速12.5% → 营收22.44亿
#   中性: 订单增速25.0% → 营收32.81亿
#   乐观: 订单增速32.5% → 营收43.82亿
#
# 📊 净利润预测（中性）:
#   营收: 32.81亿元
#   净利润: 2.79亿元
#   净利率: 8.5%
```

**集成场景**:
- 个股深度分析: 预测未来2-3年营收/净利润
- 投资决策: 基于预测估值（Forward PE）
- 建仓建议: 结合预测增速给出买卖建议

---

## 9️⃣ 投资建议框架

### 估值评估体系

| 估值指标 | 合理区间 | 评价标准 | 操作建议 |
|:---------|:---------|:---------|:---------|
| PE_TTM | 40-80倍 | <40:低估, 40-80:合理, >80:高估 | 低估买入, 高估观望 |
| PB | 3-8倍 | <3:低估, 3-8:合理, >8:高估 | 结合ROE判断 |
| Forward PE | 30-50倍 | <30:低估, 30-50:合理, >50:高估 | 预测未来1年利润 |
| PEG | <1 | <1:低估, 1-2:合理, >2:高估 | PE/盈利增速 |

### 综合评分体系

| 维度 | 权重 | 评分标准 |
|:-----|:-----|:---------|
| 行业景气度 | 20% | ⭐⭐⭐⭐⭐ 极高, ⭐⭐⭐⭐ 高, ⭐⭐⭐ 中, ⭐⭐ 低 |
| 盈利能力 | 25% | ROE>15%:⭐⭐⭐⭐⭐, 10-15%:⭐⭐⭐⭐, 5-10%:⭐⭐⭐ |
| 成长性 | 20% | 营收增速>50%:⭐⭐⭐⭐⭐, 30-50%:⭐⭐⭐⭐, 10-30%:⭐⭐⭐ |
| 估值水平 | 20% | PE<40:⭐⭐⭐⭐⭐, 40-80:⭐⭐⭐⭐, 80-150:⭐⭐⭐, >150:⭐⭐ |
| 财务健康 | 15% | 负债率低+现金充裕:⭐⭐⭐⭐⭐ |

**综合评分**: 4.0+ (强烈建议), 3.0-4.0 (建议), 2.0-3.0 (观望), <2.0 (回避)

### 操作建议矩阵

| 估值水平 | 盈利能力强 | 盈利一般 | 盈利弱 |
|:---------|:-----------|:---------|:-------|
| **低估(PE<40)** | 🟢🟢🟢 强烈买入 | 🟢🟢 买入 | 🟢 谨慎买入 |
| **合理(PE40-80)** | 🟢 买入 | 🟡 观望 | 🔴 回避 |
| **高估(PE80-150)** | 🟡 观望 | 🔴 回避 | 🔴🔴 强烈回避 |
| **极高(PE>150)** | 🔴 回避 | 🔴🔴 强烈回避 | 🔴🔴🔴 极度危险 |

### 关键跟踪指标

**必须跟踪**:
- 季度订单公告/重大合同
- 季度业绩快报/预告
- 月度产能利用率
- 核心客户导入进度

**建议跟踪**:
- 行业出货量数据
- 竞争对手动态
- 上游原材料价格
- 下游需求变化

---

## 🔟 数据验证与交叉检验

### 单一数据源不可靠

**必须多方验证**:
| 数据类型 | 主要来源 | 验证来源 | 交叉检验方法 |
|:---------|:---------|:---------|:-------------|
| 订单数据 | 公司公告 | 互动易问答+券商研报 | 公告金额vs调研细节 |
| 营收预测 | 券商模型 | 产业链数据+产能 | 券商预测vs产能上限 |
| 净利润 | 财报 | 杜邦分析+现金流 | 利润vs经营现金流 |
| 估值 | Tushare | 多数据源对比 | PE_TTM vs Forward PE |

### 异常数据识别

| 异常信号 | 可能原因 | 处理方法 |
|:---------|:---------|:---------|
| 净利润与经营现金流背离 | 应收账款增加/利润调节 | 重点关注现金流 |
| 订单增长但营收不增长 | 交付延迟/收入确认问题 | 检查交付进度 |
| PE异常高(>500) | 微利/亏损或数据错误 | 核实PE计算方式 |
| 毛利率突然变化 | 产品结构变化/成本波动 | 查看产品结构 |

---

## 更新日志

| 日期 | 更新内容 |
|:-----|:---------|
| 2026-03-01 | 新增订单与营收预测模块（order_revenue_predictor.py） |
| 2026-03-01 | 新增投资建议框架和估值评估体系 |
| 2026-03-01 | 新增数据验证与交叉检验方法论 |
| 2026-02-28 | 新增完整财务分析模块（financial_analyzer.py） |
| 2026-02-28 | 修复财务数据缺失同比环比的问题 |
| 2026-02-28 | 自动杜邦分析和风险警示生成 |
| 2026-02-28 | 新增`analyze_stock()`个股分析方法 |
| 2026-02-28 | 更新数据源优先级：Exa搜索 > 知识星球 > 长桥API |
| 2026-02-28 | 集成Agent Reach新闻搜索功能 |
| 2026-02-25 | 集成longport SDK，统一API调用 |
| 2026-02-25 | 添加知识星球自动获取 |
| 2026-02-25 | 完善产业链分析模块 |
